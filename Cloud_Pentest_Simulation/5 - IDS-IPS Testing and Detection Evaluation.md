# 5. IDS/IPS Testing and Detection Evaluation

This section evaluates the effectiveness of intrusion detection during the MitC attack simulation. The objective was to assess whether reconnaissance, exploitation, and post-exploitation activity could be detected or prevented.

---

## 5.1 Detection of Reconnaissance Activity (Nmap)

During the initial reconnaissance phase, Nmap scans were executed against the Windows client.

```bash
nmap -sV -p- 192.168.1.10
```

### Detection Outcome
- Snort successfully generated alerts for SYN scan behaviour
- Scan signatures were identified in IDS logs
- Reconnaissance activity was clearly visible to monitoring systems

This confirmed that baseline scanning activity was detectable.

### Evidence – Snort Alert Triggered by Nmap Scan

<img width="933" height="379" alt="image" src="https://github.com/user-attachments/assets/6aa87be3-e80a-41c2-bdf3-40ac13d6b09d" />

---

## 5.2 Detection of Exploitation Activity (Msfconsole)

Credential brute-forcing and exploitation were conducted using Hydra and Msfconsole to establish a Meterpreter session.

### Observed Behaviour
- Brute-force attempts generated limited alerts
- Some exploit-related traffic was logged
- No automatic prevention occurred
- IPS functionality was not fully enforced

Although activity was partially visible, it was not consistently blocked.

### Evidence – Snort Alert Triggered by Msfconsole Activity

<img width="933" height="379" alt="image" src="https://github.com/user-attachments/assets/a741ffcd-5976-4224-9c5d-963d28d3e518" />

---

## 5.3 Post-Exploitation and Token Abuse

Activities such as:

- Mimikatz execution
- Token extraction
- API-based cloud access using curl

were minimally detected.

This demonstrated that token-based abuse and authenticated API traffic were more difficult to identify compared to basic reconnaissance.

---

## 5.4 Limitations Identified

Several factors reduced detection effectiveness:

- Default rule configuration
- Limited rule tuning
- Resource constraints within the virtual lab
- IDS operating primarily in detection mode rather than strict prevention
- Legitimate-looking API traffic blending with normal sync behaviour

These limitations reflect real-world environments where monitoring tools are deployed but not fully optimised.

---

## 5.5 Summary

The IDS evaluation showed:

- Reconnaissance activity was clearly detectable
- Exploitation attempts were partially visible
- Post-exploitation token abuse was minimally detected
- IPS enforcement was limited

The results highlight the importance of proper rule tuning and layered defensive controls to prevent token-based cloud compromise.
