# 1. Architecture

This section provides an overview of the virtual environment created to support the MitC attack simulation. The goal was to build a controlled cloud environment where identity management, cloud storage, client behaviour, and monitoring could be evaluated end to end.

---

## 1.1 Overview and Purpose

The environment replicated a small enterprise-style cloud deployment for both offensive testing and defensive evaluation. It consisted of:

- **Proxmox VE (nested in VirtualBox)** — hosting all virtual machines.  
- **Zentyal Server** — Microsoft-compatible directory services and IAM.  
- **Nextcloud Server** — cloud storage platform using token-based authentication.  
- **Windows 10 Client** — synced with Nextcloud and generated authentication tokens.  
- **Kali Linux** — attacker VM for reconnaissance, SMB exploitation, and token capture.  
- **Snort IDS/IPS** — monitored network traffic and provided detection capability.  

Token flow and client/server sync behaviour are shown in the Architecture Diagram.

---

## 1.2 Network Design

A simplified internal network was implemented:

- One internal subnet for all virtual machines.  
- Static addressing where required.  
- Proxmox-level firewall rules.  
- Communication restricted to essential services.  

This design reduced traffic noise, simplified enumeration, and ensured only relevant services were exposed.

---

## 1.3 Architecture Diagram

<img width="1280" height="720" alt="Network Addressing Scheme" src="https://github.com/user-attachments/assets/35ccf6a2-3c75-46d7-9ee6-071b92fc6407" />

---

## 1.4 Architectural Decisions

This architecture was chosen because it:

- Enabled realistic simulation of cloud storage workflows.  
- Allowed full control over IAM and cloud layers.  
- Provided visibility of token behaviour and storage.  
- Supported MitC attack replication and defensive evaluation.  

---

## 1.5 Limitations

- VirtualBox caused networking and stability issues during initial testing.  
- Proxmox required additional configuration but provided full isolation and reliability.  
- Resource constraints limited additional tooling (e.g., SIEM, advanced monitoring).
