# 3. Vulnerabilities and Attack Surface

This section outlines the deliberately introduced weaknesses that enabled the MitC attack simulation. These vulnerabilities reflect common misconfigurations found in small enterprise cloud environments and formed the basis for the penetration testing activities in Section 4.

## 3.1 IAM Misconfigurations

Identity and Access Management weaknesses were intentionally created to support exploitation:

- Weak user credentials (e.g., “Password1”)
- Incorrect LDAP attribute mappings
- Case-sensitivity issues during user synchronisation
- Over-privileged user account (“Alice”)
- Misaligned RBAC roles and directory permissions

These misconfigurations replicated realistic IAM oversight that commonly enables lateral movement and token compromise.

## 3.2 Exposed and Weak SMB Configuration

The Windows 10 client included an exposed SMB service with limited security controls.

### Identified Weaknesses
- SMB accessible from the attacker VM
- Weak authentication allowed brute-force attempts
- Misconfigured sharing and access rights

### Useful Recon Commands
```bash
nmap -p445 192.168.1.10
smbclient -L //192.168.1.10/
```

These weaknesses provided an entry point for credential attempts and remote access.

## 3.3 Token-Based Authentication Weaknesses

Nextcloud uses token-based authentication for its sync client. The following weaknesses were present:

- Sync token stored in Windows Credential Manager
- Token reusable without re-authentication
- No additional protection applied to Credential Manager entries
- Lack of hardening around local credential storage

These weaknesses formed the foundation of the MitC attack path.

## 3.4 Windows Client Weaknesses

The Windows 10 configuration intentionally included:

- No endpoint tamper protection
- Default permissions on key directories
- Writable startup folder (evaluated for persistence)
- Minimal security controls around stored credentials

This created a realistic target for token extraction and testing of privilege boundaries.

## 3.5 Cloud Sync Misconfigurations

Additional vulnerabilities were present in the sync process:

- Limited restrictions on API access
- IAM-to-cloud role mappings inconsistently applied
- Predictable user attributes used during LDAP synchronisation

These contributed to the ease of token reuse during the attack.

## 3.6 Attacker Visibility and Network Exposure

The attacker VM shared the same LAN as the Windows client and cloud servers, allowing straightforward enumeration and discovery.

### Example Scan
```bash
nmap -sV 192.168.1.0/24
```

This provided full visibility of essential services, enabling targeted exploitation.

## 3.7 Summary

The vulnerabilities in IAM, SMB, token storage, Windows configuration, and cloud integration were intentionally introduced to support realistic MitC exploitation. Together, they produced a credible attack surface for the offensive testing activities documented in Section 4.
