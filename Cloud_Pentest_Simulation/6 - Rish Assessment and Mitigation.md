# 6. Risk Assessment and Mitigation

Following successful exploitation and MitC compromise, a structured mitigation phase was implemented to reduce the attack surface and strengthen identity, network, and cloud controls. The objective was to prevent replication of the original attack path.

---

## 6.1 Key Risks Identified

The penetration testing phase exposed the following critical risks:

- Weak Administrator credentials susceptible to brute-force attack
- Over-privileged IAM role distribution
- Exposed SMB service enabling remote access
- Reusable synchronisation token stored locally
- Lack of multi-factor authentication
- Limited network-level traffic blocking at the victim endpoint

These weaknesses collectively enabled full cloud compromise.

---

## 6.2 Identity and Access Management Hardening

IAM controls were restructured to enforce proper role separation and least privilege principles.

Mitigations included:

- Correcting IAM role separation
- Removing excessive privileges from user accounts
- Replacing default credentials in both local and domain directories
- Enforcing strong password policy requirements
- Enabling Two-Factor Authentication (2FA) for Nextcloud login

These changes directly addressed credential abuse and token-based compromise.

---

## 6.3 Service and Network Hardening

The exposed remote service vector was eliminated.

Mitigations included:

- Removing SMB service usage on the client LAN
- Limiting access to network resource shares
- Applying IP address filtering on Nextcloud
- Deploying **Fail2ban** to restrict repeated authentication attempts
- Implementing IDS/IPS monitoring on the client network

This reduced the external attack surface and introduced blocking capability.

---

## 6.4 Endpoint Protection Enhancements

Endpoint security posture was strengthened by:

- Enforcing Defender protections
- Restoring memory integrity settings
- Restricting unauthorised tool execution
- Improving credential storage protection

These controls reduced the feasibility of post-exploitation and credential dumping.

---

## 6.5 Re-Testing and Validation

After mitigation steps were applied, the original attack workflow was re-attempted.

Observed results:

- Hydra brute-force attempts failed under enforced password policy
- SMB-based remote access was no longer available
- Mimikatz execution was blocked
- Token extraction was no longer achievable
- Direct API token reuse was restricted

The original MitC attack chain could not be replicated in its previous form.

---

## 6.6 Outcome

The mitigation phase successfully:

- Eliminated weak credential exposure
- Enforced least privilege IAM design
- Removed unnecessary remote services
- Strengthened cloud authentication controls
- Introduced layered detection and prevention mechanisms

This demonstrated measurable improvement in the overall security posture of the cloud environment following structured risk remediation.
