# 3. Vulnerabilities and Attack Surface

This section outlines the deliberately introduced weaknesses that enabled the MitC attack simulation. The attack surface was intentionally designed to replicate realistic small-enterprise cloud misconfigurations and identity management failures.

## 3.1 IAM Misconfigurations

Identity and Access Management weaknesses were intentionally created to model common cloud deployment errors:

- Weak user credentials (e.g., “Password1”)
- Unchanged default credentials on privileged accounts
- Incorrect LDAP attribute mappings
- Case-sensitivity issues during user synchronisation
- Over-privileged user account (“Alice”)
- Misaligned RBAC roles and directory permissions

These misconfigurations simulated real-world IAM oversights that enable credential abuse, privilege misuse, and token compromise.

## 3.2 SMB Remote Service Exposure

SMB was intentionally enabled on the Windows client to simulate remote service exploitation and credential-based access scenarios.

### Identified Weaknesses
- SMB accessible from the attacker VM
- Weak authentication permitting brute-force attempts
- Misconfigured sharing and access rights

### Example Recon
```bash
nmap -p445 192.168.1.10
smbclient -L //192.168.1.10/
```

This configuration created a realistic entry point for initial access.

## 3.3 Token-Based Authentication Weaknesses

Nextcloud uses token-based authentication for its sync client. The following weaknesses were present:

- Local superuser account compromised due to default credentials
- Synchronisation token reusable without re-authentication
- No additional protection applied to Credential Manager entries
- No endpoint hardening to restrict token extraction

These weaknesses directly enabled the MitC attack path.

## 3.4 Windows Client Weaknesses

The Windows 10 endpoint was configured with minimal hardening to reflect a typical SME deployment:

- Default local account credentials; including commonly used passwords
- No endpoint tamper protection during early testing
- Default permissions on key directories
- Writable startup folder (evaluated for persistence)
- Limited monitoring of credential access

This provided a practical target for post-exploitation testing.

## 3.5 Cloud Integration Weaknesses

Weaknesses in the IAM-to-cloud integration increased exposure:

- Limited API access restrictions
- Inconsistent role enforcement between Zentyal and Nextcloud
- Predictable user attribute configuration

These factors contributed to the feasibility of token reuse and cloud data access.

## 3.6 Summary

The attack surface combined IAM misconfiguration, exposed remote services, weak endpoint security, and token-based authentication weaknesses. Together, these conditions produced a realistic environment for testing full Man-in-the-Cloud exploitation.
